define(["exports"],(function(e){"use strict";function t(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}const n=[],r=[],o=(e,t)=>{if(e===t)return 0;const o=e;e.length>t.length&&(e=t,t=o);let i=e.length,a=t.length;for(;i>0&&e.charCodeAt(~-i)===t.charCodeAt(~-a);)i--,a--;let s,c,l,d,u=0;for(;u<i&&e.charCodeAt(u)===t.charCodeAt(u);)u++;if(i-=u,a-=u,0===i)return a;let f=0,h=0;for(;f<i;)r[f]=e.charCodeAt(u+f),n[f]=++f;for(;h<a;)for(s=t.charCodeAt(u+h),l=h++,c=h,f=0;f<i;f++)d=s===r[f]?l:l+1,l=n[f],c=n[f]=l>c?d>c?c+1:d:d>l?l+1:d;return c};var i=o,a=o;i.default=a;const s=(()=>{if("undefined"==typeof window)return{};const{userAgent:e,platform:t,maxTouchPoints:n}=window.navigator,r=/(iphone|ipod|ipad)/i.test(e),o="MacIntel"===t&&n>0&&!window.MSStream;return{mobile:/android/i.test(e)||r||o,safari12:/Version\/12.+Safari/.test(e)}})(),c=(e,n=(n=>t(void 0,void 0,void 0,(function*(){try{return yield(t=`${e}/${n}`,r=r||{},new Promise((function(e,n){var o=new XMLHttpRequest,i=[],a=[],s={},c=function(){return{ok:2==(o.status/100|0),statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:c,headers:{keys:function(){return i},entries:function(){return a},get:function(e){return s[e.toLowerCase()]},has:function(e){return e.toLowerCase()in s}}}};for(var l in o.open(r.method||"get",t,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(function(e,t,n){i.push(t=t.toLowerCase()),a.push([t,n]),s[t]=s[t]?s[t]+","+n:n})),e(c())},o.onerror=n,o.withCredentials="include"==r.credentials,r.headers)o.setRequestHeader(l,r.headers[l]);o.send(r.body||null)}))).then(e=>e.json())}catch(e){return void console.log(e)}var t,r}))),r,o,a)=>t(void 0,void 0,void 0,(function*(){r=r.toLowerCase().replace(/angle \((.+)\)*$/,"$1").replace(/\s+([0-9]+gb|direct3d.+$)|\(r\)| \([^\)]+\)$/g,"");const e=o?["adreno","apple","mali-t","mali","nvidia","powervr"]:["intel","amd","radeon","nvidia","geforce"];let t;for(let n=0;n<e.length;n++){const o=e[n];if(r.indexOf(o)>-1){t=o;break}}if(!t)return[];const s=`${o?"m":"d"}-${t}.json`,c=yield n(s);if(!c)return[];const l=(e=>{var t;const n=(e=e.replace(/\([^\)]+\)/,"")).match(/[\d]+/)||e.match(/(\W|^)([a-zA-Z]{1,3})(\W|$)/g);return null!==(t=null==n?void 0:n.join("").replace(/\W|amd/g,""))&&void 0!==t?t:""})(r);let d=c.filter(([,e])=>e===l);d.length||(d=c.filter(([e])=>e.indexOf(r)>-1));const u=d.length;if(0===u)return[];const[f,,h,p]=u>1?d.map(e=>[e,i(r,e[0])]).sort(([,e],[,t])=>e-t)[0][0]:d[0];let v=0,m=Number.MAX_VALUE;const g=a.width*a.height;for(let e=0;e<p.length;e++){let[t,n,r]=p[e];const o=t*n,i=Math.abs(g-o);i<m&&(m=i,v=r)}return[h?-1:v,f]}));e.getGPUTier=({mobileTiers:e=[0,30,60],desktopTiers:n=[0,30,60],renderer:r,mobile:o=!!s.mobile,glContext:i,failIfMajorPerformanceCaveat:a=!0,screen:l=("undefined"==typeof window?{width:1920,height:1080}:window.screen),benchmarksUrl:d="/benchmarks",loadBenchmarks:u}={})=>t(void 0,void 0,void 0,(function*(){const f=(e,t,n,r)=>({tier:e,mobile:o,type:t,model:n,fps:r}),h=f(1,"FALLBACK");if(!r){const e=i||((e,t=!0)=>{const n={alpha:!1,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:t,powerPreference:"high-performance",stencil:!1};e&&delete n.powerPreference;const r=document.createElement("canvas");return r.getContext("webgl",n)||r.getContext("experimental-webgl",n)||void 0})(s.safari12,a);if(!e)return f(0,"WEBGL_UNSUPPORTED");const n=e.getExtension("WEBGL_debug_renderer_info");if(n&&(r=e.getParameter(n.UNMASKED_RENDERER_WEBGL)),!r)return h;r=yield((e,n,r)=>t(void 0,void 0,void 0,(function*(){return n})))(0,r)}const[p,v]=yield c(d,u,r,o,l);if(void 0===p)return h;if(-1===p)return f(0,"BLACKLISTED");const m=o?e:n;let g=0;for(let e=0;e<m.length;e++)p>=m[e]&&(g=e);return f(g,"BENCHMARK",v,p)})),Object.defineProperty(e,"__esModule",{value:!0})}));
