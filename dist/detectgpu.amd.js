define(["exports"],(function(e){"use strict";function t(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function s(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}c((r=r.apply(e,t||[])).next())}))}const n=[],r=[],o=(e,t)=>{if(e===t)return 0;const o=e;e.length>t.length&&(e=t,t=o);let a=e.length,i=t.length;for(;a>0&&e.charCodeAt(~-a)===t.charCodeAt(~-i);)a--,i--;let s,c,l,d,u=0;for(;u<a&&e.charCodeAt(u)===t.charCodeAt(u);)u++;if(a-=u,i-=u,0===a)return i;let f=0,p=0;for(;f<a;)r[f]=e.charCodeAt(u+f),n[f]=++f;for(;p<i;)for(s=t.charCodeAt(u+p),l=p++,c=p,f=0;f<a;f++)d=s===r[f]?l:l+1,l=n[f],c=n[f]=l>c?d>c?c+1:d:d>l?l+1:d;return c};var a=o,i=o;a.default=i;const s=(()=>{if("undefined"==typeof window)return{};const{userAgent:e,platform:t,maxTouchPoints:n}=window.navigator,r=/(iphone|ipod|ipad)/i.test(e),o="iPad"===t||"MacIntel"===t&&n>0&&!window.MSStream;return{isMobile:/android/i.test(e)||r||o,isSafari12:/Version\/12.+Safari/.test(e),isIpad:o}})(),c=(e,t,n,r)=>"apple gpu"===t?((e,t,n,r)=>{let o=[t];if(n){const t="\n      precision highp float;\n      attribute vec3 aPosition;\n      varying float vvv;\n      void main() {\n        vvv = 0.31622776601683794;\n        gl_Position = vec4(aPosition, 1.0);\n      }\n    ",n="\n      precision highp float;\n      varying float vvv;\n      void main() {\n        vec4 enc = vec4(1.0, 255.0, 65025.0, 16581375.0) * vvv;\n        enc = fract(enc);\n        enc -= enc.yzww * vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0, 0.0);\n        gl_FragColor = enc;\n      }\n    ",a=e.createShader(35633),i=e.createShader(35632),c=e.createProgram();if(i&&a&&c){e.shaderSource(a,t),e.shaderSource(i,n),e.compileShader(a),e.compileShader(i),e.attachShader(c,a),e.attachShader(c,i),e.linkProgram(c),e.detachShader(c,a),e.detachShader(c,i),e.deleteShader(a),e.deleteShader(i),e.useProgram(c);const l=e.createBuffer();e.bindBuffer(34962,l),e.bufferData(34962,new Float32Array([-1,-1,0,3,-1,0,-1,3,0]),35044);const d=e.getAttribLocation(c,"aPosition");e.vertexAttribPointer(d,3,5126,!1,0,0),e.enableVertexAttribArray(d),e.clearColor(1,1,1,1),e.clear(16384),e.viewport(0,0,1,1),e.drawArrays(4,0,3);const u=new Uint8Array(4);e.readPixels(0,0,1,1,6408,5121,u),e.deleteProgram(c),e.deleteBuffer(l),o={801621810:s.isIpad?["apple a12x gpu"]:["apple a11 gpu","apple a12 gpu","apple a13 gpu"],8016218135:s.isIpad?["apple a9x gpu","apple a10 gpu","apple a10x gpu"]:["apple a9 gpu","apple a10 gpu"]}[u.join("")]||o,r&&console.warn("iOS 12.2+ obfuscates its GPU type and version, using closest matches: "+o)}}else r&&console.warn("Safari 14+ obfuscates its GPU type and version, using fallback");return o})(e,t,n,r):[t],l={};e.getGPUTier=({mobileTiers:e=[0,30,60],desktopTiers:n=[0,30,60],logging:r=!1,override:{renderer:o,isIpad:i=!!s.isIpad,isMobile:d=!!s.isMobile,screen:u=("undefined"==typeof window?{width:1920,height:1080}:window.screen),loadBenchmarks:f}={},glContext:p,failIfMajorPerformanceCaveat:h=!0,benchmarksUrl:g="/benchmarks"}={})=>t(void 0,void 0,void 0,(function*(){const v=(e,n=(n=>t(void 0,void 0,void 0,(function*(){try{return yield(t=`${e}/${n}`,r=r||{},new Promise((function(e,n){var o=new XMLHttpRequest,a=[],i=[],s={},c=function(){return{ok:2==(o.status/100|0),statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:c,headers:{keys:function(){return a},entries:function(){return i},get:function(e){return s[e.toLowerCase()]},has:function(e){return e.toLowerCase()in s}}}};for(var l in o.open(r.method||"get",t,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(function(e,t,n){a.push(t=t.toLowerCase()),i.push([t,n]),s[t]=s[t]?s[t]+","+n:n})),e(c())},o.onerror=n,o.withCredentials="include"==r.credentials,r.headers)o.setRequestHeader(l,r.headers[l]);o.send(r.body||null)}))).then(e=>e.json())}catch(e){return void console.log(e)}var t,r}))),r)=>t(void 0,void 0,void 0,(function*(){r=r.toLowerCase().replace(/angle \((.+)\)*$/,"$1").replace(/\s+([0-9]+gb|direct3d.+$)|\(r\)| \([^\)]+\)$/g,"");const e=d?["adreno","apple","mali-t","mali","nvidia","powervr"]:["intel","amd","radeon","nvidia","geforce"];let t;for(let n=0;n<e.length;n++){const o=e[n];if(r.indexOf(o)>-1){t=o;break}}if(!t)return[];const o=`${d?"m":"d"}-${t}.json`,s=l[o]=l[o]||n(o),c=yield s;if(!c)return[];const f=(e=>{var t;const n=(e=e.replace(/\([^\)]+\)/,"")).match(/[\d]+/)||e.match(/(\W|^)([a-zA-Z]{1,3})(\W|$)/g);return null!==(t=null==n?void 0:n.join("").replace(/\W|amd/g,""))&&void 0!==t?t:""})(r),p="apple"===t;let h=c.filter(([,e])=>e===f);h.length||(h=c.filter(([e])=>e.indexOf(r)>-1));const g=h.length;if(0===g)return[];let v,[m,,w,b]=g>1?h.map(e=>[e,a(r,e[0])]).sort(([,e],[,t])=>e-t)[0][0]:h[0],P=Number.MAX_VALUE;const{devicePixelRatio:A}=window,S=u.width*A*(u.height*A);p&&(b=b.filter(([,,,e])=>e.indexOf(i?"ipad":"iphone")>-1));for(let e=0;e<b.length;e++){const t=b[e],[n,r]=t,o=n*r,a=Math.abs(S-o);a<P&&(P=a,v=t)}const[,,x,y]=v;return[P,w?-1:x,m,y]})),m=(e,t,n,r,o)=>({tier:e,isMobile:d,type:t,fps:n,gpu:r,device:o});let w;const b=m(1,"FALLBACK");if(o)w=[o];else{const e=p||((e,t=!0)=>{const n={alpha:!1,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:t,powerPreference:"high-performance",stencil:!1};e&&delete n.powerPreference;const r=document.createElement("canvas");return r.getContext("webgl",n)||r.getContext("experimental-webgl",n)||void 0})(s.isSafari12,h);if(!e)return m(0,"WEBGL_UNSUPPORTED");const t=e.getExtension("WEBGL_debug_renderer_info");if(t&&(o=e.getParameter(t.UNMASKED_RENDERER_WEBGL).toLowerCase()),!o)return b;w=c(e,o,d,r)}const P=yield Promise.all(w.map(e=>v(g,f,e))),A=1===P.length?P[0]:P.sort(([e=Number.MAX_VALUE],[t=Number.MAX_VALUE])=>e-t)[0];if(0===A.length)return b;const[,S,x,y]=A;if(-1===S)return m(0,"BLACKLISTED",S,x,y);const C=d?e:n;let L=0;for(let e=0;e<C.length;e++)S>=C[e]&&(L=e);return m(L,"BENCHMARK",S,x,y)})),Object.defineProperty(e,"__esModule",{value:!0})}));
