"use strict";function e(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))}Object.defineProperty(exports,"__esModule",{value:!0});const t=[],n=[],r=(e,r)=>{if(e===r)return 0;const o=e;e.length>r.length&&(e=r,r=o);let i=e.length,s=r.length;for(;i>0&&e.charCodeAt(~-i)===r.charCodeAt(~-s);)i--,s--;let a,c,l,d,u=0;for(;u<i&&e.charCodeAt(u)===r.charCodeAt(u);)u++;if(i-=u,s-=u,0===i)return s;let f=0,h=0;for(;f<i;)n[f]=e.charCodeAt(u+f),t[f]=++f;for(;h<s;)for(a=r.charCodeAt(u+h),l=h++,c=h,f=0;f<i;f++)d=a===n[f]?l:l+1,l=t[f],c=t[f]=l>c?d>c?c+1:d:d>l?l+1:d;return c};var o=r,i=r;o.default=i;const s=(()=>{if("undefined"==typeof window)return{};const{userAgent:e,platform:t,maxTouchPoints:n}=window.navigator,r=/(iphone|ipod|ipad)/i.test(e),o="MacIntel"===t&&n>0&&!window.MSStream;return{mobile:/android/i.test(e)||r||o,safari12:/Version\/12.+Safari/.test(e)}})(),a=(t,n=(n=>e(void 0,void 0,void 0,(function*(){try{return yield(e=`${t}/${n}`,r=r||{},new Promise((function(t,n){var o=new XMLHttpRequest,i=[],s=[],a={},c=function(){return{ok:2==(o.status/100|0),statusText:o.statusText,status:o.status,url:o.responseURL,text:function(){return Promise.resolve(o.responseText)},json:function(){return Promise.resolve(o.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([o.response]))},clone:c,headers:{keys:function(){return i},entries:function(){return s},get:function(e){return a[e.toLowerCase()]},has:function(e){return e.toLowerCase()in a}}}};for(var l in o.open(r.method||"get",e,!0),o.onload=function(){o.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,(function(e,t,n){i.push(t=t.toLowerCase()),s.push([t,n]),a[t]=a[t]?a[t]+","+n:n})),t(c())},o.onerror=n,o.withCredentials="include"==r.credentials,r.headers)o.setRequestHeader(l,r.headers[l]);o.send(r.body||null)}))).then(e=>e.json())}catch(e){return void console.log(e)}var e,r}))),r,i,s)=>e(void 0,void 0,void 0,(function*(){r=r.toLowerCase().replace(/angle \((.+)\)*$/,"$1").replace(/\s+([0-9]+gb|direct3d.+$)|\(r\)| \([^\)]+\)$/g,"");const e=i?["adreno","apple","mali-t","mali","nvidia","powervr"]:["intel","amd","radeon","nvidia","geforce"];let t;for(let n=0;n<e.length;n++){const o=e[n];if(r.indexOf(o)>-1){t=o;break}}if(!t)return[];const a=`${i?"m":"d"}-${t}.json`,c=yield n(a);if(!c)return[];const l=(e=>{var t;const n=(e=e.replace(/\([^\)]+\)/,"")).match(/[\d]+/)||e.match(/(\W|^)([a-zA-Z]{1,3})(\W|$)/g);return null!==(t=null==n?void 0:n.join("").replace(/\W|amd/g,""))&&void 0!==t?t:""})(r);let d=c.filter(([,e])=>e===l);d.length||(d=c.filter(([e])=>e.indexOf(r)>-1));const u=d.length;if(0===u)return[];const[f,,h,p]=u>1?d.map(e=>[e,o(r,e[0])]).sort(([,e],[,t])=>e-t)[0][0]:d[0];let v=0,m=Number.MAX_VALUE;const g=s.width*s.height;for(let e=0;e<p.length;e++){let[t,n,r]=p[e];const o=t*n,i=Math.abs(g-o);i<m&&(m=i,v=r)}return[h?-1:v,f]}));exports.getGPUTier=({mobileTiers:t=[0,30,60],desktopTiers:n=[0,30,60],renderer:r,mobile:o=!!s.mobile,glContext:i,failIfMajorPerformanceCaveat:c=!0,screen:l=("undefined"==typeof window?{width:1920,height:1080}:window.screen),benchmarksUrl:d="/benchmarks",loadBenchmarks:u}={})=>e(void 0,void 0,void 0,(function*(){const f=(e,t,n,r)=>({tier:e,mobile:o,type:t,model:n,fps:r}),h=f(1,"FALLBACK");if(!r){const t=i||((e,t=!0)=>{const n={alpha:!1,antialias:!1,depth:!1,failIfMajorPerformanceCaveat:t,powerPreference:"high-performance",stencil:!1};e&&delete n.powerPreference;const r=document.createElement("canvas");return r.getContext("webgl",n)||r.getContext("experimental-webgl",n)||void 0})(s.safari12,c);if(!t)return f(0,"WEBGL_UNSUPPORTED");const n=t.getExtension("WEBGL_debug_renderer_info");if(n&&(r=t.getParameter(n.UNMASKED_RENDERER_WEBGL)),!r)return h;r=yield((t,n,r)=>e(void 0,void 0,void 0,(function*(){return n})))(0,r)}const[p,v]=yield a(d,u,r,o,l);if(void 0===p)return h;if(-1===p)return f(0,"BLACKLISTED");const m=o?t:n;let g=0;for(let e=0;e<m.length;e++)p>=m[e]&&(g=e);return f(g,"BENCHMARK",v,p)}));
